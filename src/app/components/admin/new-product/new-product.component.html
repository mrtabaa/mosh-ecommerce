<form #f="ngForm" (ngSubmit)="onSubmit(f.value); f.reset();" fxLayout="column">
    <!-- 1st row -->
    <ng-container *ngIf="(isAddedType || isAddedCategory)">
        <p *ngIf="isAddedType" class="newItemAdded" fxFlex="40" fxFlex.lt-sm="80" fxLayoutAlign="center center">
            <ng-container *ngIf="isAlreadyExist$ | async; else exists">
                {{addedType}} already exists in the Type list.
            </ng-container>
            <ng-template #exists>
                {{addedType}} added to the Type list.
            </ng-template>
        </p>
        <p *ngIf="isAddedCategory" class="newItemAdded" fxFlex="40" fxFlex.lt-sm="80" fxLayoutAlign="center center">
            <ng-container *ngIf="isAlreadyExist$ | async; else exists">
                {{addedCategory}} added to the {{selectedType.value}}'s category.
            </ng-container>
            <ng-template #exists>
                {{addedCategory}} already exists in the {{selectedType.value}} Type.
            </ng-template>
        </p>
    </ng-container>
    <!-- TYPE -->
    <div fxLayout="row wrap" fxLayoutAlign="space-around center">
        <mat-form-field fxFlex="40" fxFlex.lt-sm="80">
            <mat-select placeholder="Type" required ngModel name="type" #selectedType [(value)]="tempType">
                <!-- newType option -->
                <mat-option value="newType">
                    <mat-icon>add_circle_outline</mat-icon>
                    New Type
                </mat-option>
                <!-- MUST USE mat-select-trigger TO SHOW mat-icon -->
                <mat-select-trigger *ngIf="selectedType.value === 'newType'">
                    <mat-icon>add_circle_outline</mat-icon>
                    Fill out New Type field.
                </mat-select-trigger>
                <!-- types -->
                <mat-option *ngFor="let item of types$ | async" [value]="item.key" (click)="getCategories(item.key)">
                    {{item.key}}
                </mat-option>
            </mat-select>
        </mat-form-field>
        <!-- newType input -->
        <mat-form-field *ngIf="selectedType.value === 'newType'" fxFlex="40" fxFlex.lt-sm="80" fxLayout="column">
            <input fxFlex matInput placeholder="New Type" required #newTypeOnKeyup (keyup)="newTypeOnKeyup.value"
                (keyup.enter)="addType(newTypeOnKeyup)" />
            <button type="button" mat-mini-fab class="btnNewType" (click)="addType(newTypeOnKeyup)"
                [disabled]="newTypeOnKeyup.value === ''">Add</button>
        </mat-form-field>

        <!-- CATEGORY -->
        <span id="category" fxFlex="40" fxFlex.lt-sm="80" fxLayout="column" *ngIf="selectedType.value !== 'newType'">
            <mat-form-field>
                <mat-select placeholder="Category" required ngModel name="category" #selectedCategory>
                    <!-- newCategory option -->
                    <span *ngIf="selectedType.value !== null">
                        <mat-option value="newCategory" *ngIf="selectedType.value !== ''">
                            <mat-icon>add_circle_outline</mat-icon>
                            New Category
                        </mat-option>
                    </span>
                    <mat-select-trigger *ngIf="selectedCategory.value === 'newCategory' && selectedType.value !== ''">
                        <mat-icon>add_circle_outline</mat-icon>
                        Fill out New Category field.
                    </mat-select-trigger>
                    <!-- categories -->
                    <ng-container *ngFor="let item of categories$ | async; index as i">
                        <mat-option *ngIf="item.category !== ''" [value]="item.category">
                            {{item.category}}
                        </mat-option>
                    </ng-container>
                </mat-select>
            </mat-form-field>
            <!-- newCategory input -->
            <mat-form-field *ngIf="selectedCategory.value === 'newCategory'" fxFlex="40" fxFlex.lt-sm="80"
                fxLayout="column">
                <input fxFlex matInput placeholder="New Category" required #newCategoryOnKeyup
                    (keyup)="newCategoryOnKeyup.value"
                    (keyup.enter)="addCategory(newCategoryOnKeyup, selectedType.value)" />
                <button type="button" mat-mini-fab class="btnNewType"
                    (click)="addCategory(newCategoryOnKeyup, selectedType.value)"
                    [disabled]="newCategoryOnKeyup.value === ''">
                    Add
                </button>
            </mat-form-field>
        </span>
    </div>

    <!-- 2nd row -->
    <div fxLayout="row wrap" fxLayoutAlign="space-around center">
        <!-- TITLE -->
        <mat-form-field fxFlex="40" fxFlex.lt-sm="80">
            <input matInput placeholder="Title" ngModel name="title" required minlength="3">
        </mat-form-field>
        <!-- PRICE -->
        <mat-form-field fxFlex="40" fxFlex.lt-sm="80">
            <input matInput placeholder="Price" required ngModel name="price">
            <span matPrefix>$&nbsp;</span>
        </mat-form-field>
        <!-- 3rd row -->
        <!-- IMAGEURL -->
        <mat-form-field fxFlex="80">
            <input matInput placeholder="Image URL" required ngModel name="imageUrl">
        </mat-form-field>
    </div>
    <!-- 4rd row -->
      <p>{{ f.value | json }}</p>
    <button fxFlexAlign="center" mat-raised-button color="primary" [disabled]="f.invalid" class="btnSave">Save</button>
</form>